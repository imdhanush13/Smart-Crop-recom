<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ðŸŒ± Smart Crop Recommendation</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(-45deg, #7bc47f, #dfeecb, #b4e7d9, #f2f6f7);
      background-size: 400% 400%;
      animation: gradient 15s ease infinite;
      font-family: Arial, sans-serif;
    }

    @keyframes gradient {
      0% {background-position: 0% 50%;}
      50% {background-position: 100% 50%;}
      100% {background-position: 0% 50%;}
    }

    .container {
      margin-top: 50px;
    }

    .card {
      padding: 30px;
      border-radius: 15px;
      background-color: rgba(255, 255, 255, 0.9);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }
  </style>
</head>
<body>
  <div class="container">
    <h2 class="text-center mb-4">ðŸŒ¾ Smart Crop Recommendation System</h2>
    <div class="card col-lg-10 mx-auto">
      <form method="POST" action="/predict">
        <div class="row g-3">
          <div class="col-md-4">
            <label for="state">State:</label>
            <input type="text" name="state" id="state" class="form-control" placeholder="e.g., Tamil Nadu" required>
          </div>
          <div class="col-md-4">
            <label for="district">District:</label>
            <input type="text" name="district" id="district" class="form-control" placeholder="e.g., Chennai" required>
          </div>
          <div class="col-md-4">
            <label for="duration">Duration (months):</label>
            <input type="number" name="duration" id="duration" class="form-control" min="1" max="12" required>
          </div>

          <div class="col-md-12">
            <button type="button" onclick="fetchData()" class="btn btn-info w-100">ðŸ“¡ Fetch Weather & Rainfall</button>
          </div>

          <hr class="mt-4">

          <div class="col-md-4">
            <label for="temperature">Temperature (Â°C):</label>
            <input type="number" step="any" name="temperature" id="temperature" class="form-control" readonly>
          </div>
          <div class="col-md-4">
            <label for="humidity">Humidity (%):</label>
            <input type="number" step="any" name="humidity" id="humidity" class="form-control" readonly>
          </div>
          <div class="col-md-4">
            <label for="rainfall">Rainfall (mm):</label>
            <input type="number" step="any" name="rainfall" id="rainfall" class="form-control" readonly>
          </div>

          <div class="col-md-4">
            <label for="N">Nitrogen (N):</label>
            <input type="number" name="N" id="N" class="form-control" required>
          </div>
          <div class="col-md-4">
            <label for="P">Phosphorus (P):</label>
            <input type="number" name="P" id="P" class="form-control" required>
          </div>
          <div class="col-md-4">
            <label for="K">Potassium (K):</label>
            <input type="number" name="K" id="K" class="form-control" required>
          </div>
          <div class="col-md-4">
            <label for="ph">pH:</label>
            <input type="number" step="any" name="ph" id="ph" class="form-control" required>
          </div>

          <div class="col-md-4 d-flex align-items-end">
            <input type="submit" value="ðŸŒ± Predict Crop" class="btn btn-success w-100">
          </div>
          <div class="col-md-4 d-flex align-items-end">
            <a href="/" class="btn btn-secondary w-100">Reset</a>
          </div>
        </div>
      </form>

      {% if show_prediction %}
      <div class="alert alert-info mt-4 text-center">
        <h5>{{ prediction_text }}</h5>
      </div>
      {% endif %}
    </div>
  </div>

  <script>
    function fetchData() {
      const state = document.getElementById('state').value.trim();
      const district = document.getElementById('district').value.trim();
      const duration = document.getElementById('duration').value;

      if (!state || !district || !duration) {
        alert("Please fill State, District and Duration first.");
        return;
      }

      fetch(`/fetch-weather?state=${state}&district=${district}&duration=${duration}`)
        .then(res => res.json())
        .then(data => {
          document.getElementById('temperature').value = data.temperature;
          document.getElementById('humidity').value = data.humidity;
          document.getElementById('rainfall').value = data.rainfall;
        })
        .catch(err => {
          alert("Error fetching weather data.");
          console.error(err);
        });
    }
  </script>
</body>
</html>
