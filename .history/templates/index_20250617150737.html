<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ðŸŒ± Smart Crop Recommendation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* Moving background animation */
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(-45deg, #7bc47f, #dfeecb, #b4e7d9, #f2f6f7);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            font-family: Arial, sans-serif;
        }

        @keyframes gradient {
            0% {background-position: 0% 50%;}
            50% {background-position: 100% 50%;}
            100% {background-position: 0% 50%;}
        }

        .container {
            margin-top: 50px;
        }

        .card {
            padding: 30px;
            border-radius: 15px;
            background-color: rgba(255, 255, 255, 0.9);
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .btn-success {
            background-color: #4CAF50;
            border: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="text-center mb-4">ðŸŒ¾ Smart Crop Recommendation System</h2>
        <div class="card shadow col-lg-8 mx-auto">
            <form method="POST" action="/predict">
                <div class="row g-3">
                    <div class="col-md-4">
                        <label for="N">Nitrogen (N):</label>
                        <input type="number" name="N" id="N" class="form-control" required>
                    </div>
                    <div class="col-md-4">
                        <label for="P">Phosphorus (P):</label>
                        <input type="number" name="P" id="P" class="form-control" required>
                    </div>
                    <div class="col-md-4">
                        <label for="K">Potassium (K):</label>
                        <input type="number" name="K" id="K" class="form-control" required>
                    </div>
                    <div class="col-md-4">
                        <label for="temperature">Temperature (Â°C):</label>
                        <input type="number" step="any" name="temperature" id="temperature" class="form-control" required>
                    </div>
                    <div class="col-md-4">
                        <label for="humidity">Humidity (%):</label>
                        <input type="number" step="any" name="humidity" id="humidity" class="form-control" required>
                    </div>
                    <div class="col-md-4">
                        <label for="ph">pH:</label>
                        <input type="number" step="any" name="ph" id="ph" class="form-control" required>
                    </div>
                    <div class="col-md-4">
                        <label for="rainfall">Rainfall (mm):</label>
                        <input type="number" step="any" name="rainfall" id="rainfall" class="form-control" required>
                    </div>
                    <div class="col-md-4 d-flex align-items-end">
                        <input type="submit" value="Predict" class="btn btn-success w-100">
                    </div>
                    <div class="col-md-4 d-flex align-items-end">
                        <a href="/" class="btn btn-secondary w-100">Reset</a>
                    </div>
                </div>
            </form>

            {% if show_prediction %}
            <div class="alert alert-info mt-4 text-center">
                <h5>{{ prediction_text }}</h5>
            </div>
            {% endif %}
        </div>
    </div>
    <script>
    const API_KEY = "51fbde2819c9db13b055c1ad3de8b147";

    function fetchWeather(lat, lon) {
        const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${API_KEY}`;
        fetch(url)
            .then(response => response.json())
            .then(data => {
                document.getElementById('temperature').value = data.main.temp;
                document.getElementById('humidity').value = data.main.humidity;
                document.getElementById('rainfall').value = data.rain ? data.rain["1h"]data.rain ? data.rain["1h"] || 0 : 0
 || 0 : 0;
            })
            .catch(err => console.error("Weather API error:", err));
    }

    function getLocationWeather() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    fetchWeather(lat, lon);
                },
                (err) => {
                    alert("Location permission denied. Weather data won't be autofilled.");
                    console.error("Geo error:", err);
                }
            );
        } else {
            alert("Geolocation not supported by this browser.");
        }
    }

    window.onload = getLocationWeather;
</script>

</body>

</html>
